import{C as Ct,V as _,M as T,T as D,Q as it,S as at,a as f,R as Rt,P as Ot,b as M,c as dt,B as At,d as F,e as Lt,f as $,g as p,I as pt,O as jt,h as kt,W as zt,i as It,j as Nt,k as Ft,A as Yt,D as Wt,G as W,l as R,m as ut,n as Y,o as z,L as mt,p as Ut,q as ft,r as Ht,s as Zt,E as Kt,t as Bt,u as U,v as _t,w as yt,x as Q,y as gt,z as Gt,F as Xt,H as qt,J as Vt,K as $t,N as Qt}from"./three-D-KZtToH.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function e(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(i){if(i.ep)return;i.ep=!0;const n=e(i);fetch(i.href,n)}})();const nt={type:"change"},J={type:"start"},bt={type:"end"},N=new Rt,rt=new Ot,Jt=Math.cos(70*M.DEG2RAD),d=new _,m=2*Math.PI,h={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},Z=1e-6;class te extends Ct{constructor(t,e=null){super(t,e),this.state=h.NONE,this.target=new _,this.cursor=new _,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:T.ROTATE,MIDDLE:T.DOLLY,RIGHT:T.PAN},this.touches={ONE:D.ROTATE,TWO:D.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new _,this._lastQuaternion=new it,this._lastTargetPosition=new _,this._quat=new it().setFromUnitVectors(t.up,new _(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new at,this._sphericalDelta=new at,this._scale=1,this._panOffset=new _,this._rotateStart=new f,this._rotateEnd=new f,this._rotateDelta=new f,this._panStart=new f,this._panEnd=new f,this._panDelta=new f,this._dollyStart=new f,this._dollyEnd=new f,this._dollyDelta=new f,this._dollyDirection=new _,this._mouse=new f,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=se.bind(this),this._onPointerDown=ee.bind(this),this._onPointerUp=oe.bind(this),this._onContextMenu=ce.bind(this),this._onMouseWheel=ne.bind(this),this._onKeyDown=re.bind(this),this._onTouchStart=he.bind(this),this._onTouchMove=le.bind(this),this._onMouseDown=ie.bind(this),this._onMouseMove=ae.bind(this),this._interceptControlDown=de.bind(this),this._interceptControlUp=pe.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(t){super.connect(t),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(t){t.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=t}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(nt),this.update(),this.state=h.NONE}update(t=null){const e=this.object.position;d.copy(e).sub(this.target),d.applyQuaternion(this._quat),this._spherical.setFromVector3(d),this.autoRotate&&this.state===h.NONE&&this._rotateLeft(this._getAutoRotationAngle(t)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let o=this.minAzimuthAngle,i=this.maxAzimuthAngle;isFinite(o)&&isFinite(i)&&(o<-Math.PI?o+=m:o>Math.PI&&(o-=m),i<-Math.PI?i+=m:i>Math.PI&&(i-=m),o<=i?this._spherical.theta=Math.max(o,Math.min(i,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(o+i)/2?Math.max(o,this._spherical.theta):Math.min(i,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let n=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const r=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),n=r!=this._spherical.radius}if(d.setFromSpherical(this._spherical),d.applyQuaternion(this._quatInverse),e.copy(this.target).add(d),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let r=null;if(this.object.isPerspectiveCamera){const a=d.length();r=this._clampDistance(a*this._scale);const l=a-r;this.object.position.addScaledVector(this._dollyDirection,l),this.object.updateMatrixWorld(),n=!!l}else if(this.object.isOrthographicCamera){const a=new _(this._mouse.x,this._mouse.y,0);a.unproject(this.object);const l=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),n=l!==this.object.zoom;const c=new _(this._mouse.x,this._mouse.y,0);c.unproject(this.object),this.object.position.sub(c).add(a),this.object.updateMatrixWorld(),r=d.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;r!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(r).add(this.object.position):(N.origin.copy(this.object.position),N.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(N.direction))<Jt?this.object.lookAt(this.target):(rt.setFromNormalAndCoplanarPoint(this.object.up,this.target),N.intersectPlane(rt,this.target))))}else if(this.object.isOrthographicCamera){const r=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),r!==this.object.zoom&&(this.object.updateProjectionMatrix(),n=!0)}return this._scale=1,this._performCursorZoom=!1,n||this._lastPosition.distanceToSquared(this.object.position)>Z||8*(1-this._lastQuaternion.dot(this.object.quaternion))>Z||this._lastTargetPosition.distanceToSquared(this.target)>Z?(this.dispatchEvent(nt),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(t){return t!==null?m/60*this.autoRotateSpeed*t:m/60/60*this.autoRotateSpeed}_getZoomScale(t){const e=Math.abs(t*.01);return Math.pow(.95,this.zoomSpeed*e)}_rotateLeft(t){this._sphericalDelta.theta-=t}_rotateUp(t){this._sphericalDelta.phi-=t}_panLeft(t,e){d.setFromMatrixColumn(e,0),d.multiplyScalar(-t),this._panOffset.add(d)}_panUp(t,e){this.screenSpacePanning===!0?d.setFromMatrixColumn(e,1):(d.setFromMatrixColumn(e,0),d.crossVectors(this.object.up,d)),d.multiplyScalar(t),this._panOffset.add(d)}_pan(t,e){const o=this.domElement;if(this.object.isPerspectiveCamera){const i=this.object.position;d.copy(i).sub(this.target);let n=d.length();n*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*t*n/o.clientHeight,this.object.matrix),this._panUp(2*e*n/o.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(t*(this.object.right-this.object.left)/this.object.zoom/o.clientWidth,this.object.matrix),this._panUp(e*(this.object.top-this.object.bottom)/this.object.zoom/o.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(t,e){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const o=this.domElement.getBoundingClientRect(),i=t-o.left,n=e-o.top,r=o.width,a=o.height;this._mouse.x=i/r*2-1,this._mouse.y=-(n/a)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(t){return Math.max(this.minDistance,Math.min(this.maxDistance,t))}_handleMouseDownRotate(t){this._rotateStart.set(t.clientX,t.clientY)}_handleMouseDownDolly(t){this._updateZoomParameters(t.clientX,t.clientX),this._dollyStart.set(t.clientX,t.clientY)}_handleMouseDownPan(t){this._panStart.set(t.clientX,t.clientY)}_handleMouseMoveRotate(t){this._rotateEnd.set(t.clientX,t.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const e=this.domElement;this._rotateLeft(m*this._rotateDelta.x/e.clientHeight),this._rotateUp(m*this._rotateDelta.y/e.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(t){this._dollyEnd.set(t.clientX,t.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(t){this._panEnd.set(t.clientX,t.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(t){this._updateZoomParameters(t.clientX,t.clientY),t.deltaY<0?this._dollyIn(this._getZoomScale(t.deltaY)):t.deltaY>0&&this._dollyOut(this._getZoomScale(t.deltaY)),this.update()}_handleKeyDown(t){let e=!1;switch(t.code){case this.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateUp(m*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),e=!0;break;case this.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateUp(-m*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),e=!0;break;case this.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateLeft(m*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),e=!0;break;case this.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateLeft(-m*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),e=!0;break}e&&(t.preventDefault(),this.update())}_handleTouchStartRotate(t){if(this._pointers.length===1)this._rotateStart.set(t.pageX,t.pageY);else{const e=this._getSecondPointerPosition(t),o=.5*(t.pageX+e.x),i=.5*(t.pageY+e.y);this._rotateStart.set(o,i)}}_handleTouchStartPan(t){if(this._pointers.length===1)this._panStart.set(t.pageX,t.pageY);else{const e=this._getSecondPointerPosition(t),o=.5*(t.pageX+e.x),i=.5*(t.pageY+e.y);this._panStart.set(o,i)}}_handleTouchStartDolly(t){const e=this._getSecondPointerPosition(t),o=t.pageX-e.x,i=t.pageY-e.y,n=Math.sqrt(o*o+i*i);this._dollyStart.set(0,n)}_handleTouchStartDollyPan(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enablePan&&this._handleTouchStartPan(t)}_handleTouchStartDollyRotate(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enableRotate&&this._handleTouchStartRotate(t)}_handleTouchMoveRotate(t){if(this._pointers.length==1)this._rotateEnd.set(t.pageX,t.pageY);else{const o=this._getSecondPointerPosition(t),i=.5*(t.pageX+o.x),n=.5*(t.pageY+o.y);this._rotateEnd.set(i,n)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const e=this.domElement;this._rotateLeft(m*this._rotateDelta.x/e.clientHeight),this._rotateUp(m*this._rotateDelta.y/e.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(t){if(this._pointers.length===1)this._panEnd.set(t.pageX,t.pageY);else{const e=this._getSecondPointerPosition(t),o=.5*(t.pageX+e.x),i=.5*(t.pageY+e.y);this._panEnd.set(o,i)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(t){const e=this._getSecondPointerPosition(t),o=t.pageX-e.x,i=t.pageY-e.y,n=Math.sqrt(o*o+i*i);this._dollyEnd.set(0,n),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const r=(t.pageX+e.x)*.5,a=(t.pageY+e.y)*.5;this._updateZoomParameters(r,a)}_handleTouchMoveDollyPan(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enablePan&&this._handleTouchMovePan(t)}_handleTouchMoveDollyRotate(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enableRotate&&this._handleTouchMoveRotate(t)}_addPointer(t){this._pointers.push(t.pointerId)}_removePointer(t){delete this._pointerPositions[t.pointerId];for(let e=0;e<this._pointers.length;e++)if(this._pointers[e]==t.pointerId){this._pointers.splice(e,1);return}}_isTrackingPointer(t){for(let e=0;e<this._pointers.length;e++)if(this._pointers[e]==t.pointerId)return!0;return!1}_trackPointer(t){let e=this._pointerPositions[t.pointerId];e===void 0&&(e=new f,this._pointerPositions[t.pointerId]=e),e.set(t.pageX,t.pageY)}_getSecondPointerPosition(t){const e=t.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[e]}_customWheelEvent(t){const e=t.deltaMode,o={clientX:t.clientX,clientY:t.clientY,deltaY:t.deltaY};switch(e){case 1:o.deltaY*=16;break;case 2:o.deltaY*=100;break}return t.ctrlKey&&!this._controlActive&&(o.deltaY*=10),o}}function ee(s){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(s.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(s)&&(this._addPointer(s),s.pointerType==="touch"?this._onTouchStart(s):this._onMouseDown(s)))}function se(s){this.enabled!==!1&&(s.pointerType==="touch"?this._onTouchMove(s):this._onMouseMove(s))}function oe(s){switch(this._removePointer(s),this._pointers.length){case 0:this.domElement.releasePointerCapture(s.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(bt),this.state=h.NONE;break;case 1:const t=this._pointers[0],e=this._pointerPositions[t];this._onTouchStart({pointerId:t,pageX:e.x,pageY:e.y});break}}function ie(s){let t;switch(s.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=-1}switch(t){case T.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(s),this.state=h.DOLLY;break;case T.ROTATE:if(s.ctrlKey||s.metaKey||s.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(s),this.state=h.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(s),this.state=h.ROTATE}break;case T.PAN:if(s.ctrlKey||s.metaKey||s.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(s),this.state=h.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(s),this.state=h.PAN}break;default:this.state=h.NONE}this.state!==h.NONE&&this.dispatchEvent(J)}function ae(s){switch(this.state){case h.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(s);break;case h.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(s);break;case h.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(s);break}}function ne(s){this.enabled===!1||this.enableZoom===!1||this.state!==h.NONE||(s.preventDefault(),this.dispatchEvent(J),this._handleMouseWheel(this._customWheelEvent(s)),this.dispatchEvent(bt))}function re(s){this.enabled!==!1&&this._handleKeyDown(s)}function he(s){switch(this._trackPointer(s),this._pointers.length){case 1:switch(this.touches.ONE){case D.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(s),this.state=h.TOUCH_ROTATE;break;case D.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(s),this.state=h.TOUCH_PAN;break;default:this.state=h.NONE}break;case 2:switch(this.touches.TWO){case D.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(s),this.state=h.TOUCH_DOLLY_PAN;break;case D.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(s),this.state=h.TOUCH_DOLLY_ROTATE;break;default:this.state=h.NONE}break;default:this.state=h.NONE}this.state!==h.NONE&&this.dispatchEvent(J)}function le(s){switch(this._trackPointer(s),this.state){case h.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(s),this.update();break;case h.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(s),this.update();break;case h.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(s),this.update();break;case h.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(s),this.update();break;default:this.state=h.NONE}}function ce(s){this.enabled!==!1&&s.preventDefault()}function de(s){s.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function pe(s){s.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}class ue extends dt{constructor(){super();const t=new At;t.deleteAttribute("uv");const e=new F({side:Lt}),o=new F,i=new $(16777215,900,28,2);i.position.set(.418,16.199,.3),this.add(i);const n=new p(t,e);n.position.set(-.757,13.219,.717),n.scale.set(31.713,28.305,28.591),this.add(n);const r=new pt(t,o,6),a=new jt;a.position.set(-10.906,2.009,1.846),a.rotation.set(0,-.195,0),a.scale.set(2.328,7.905,4.651),a.updateMatrix(),r.setMatrixAt(0,a.matrix),a.position.set(-5.607,-.754,-.758),a.rotation.set(0,.994,0),a.scale.set(1.97,1.534,3.955),a.updateMatrix(),r.setMatrixAt(1,a.matrix),a.position.set(6.167,.857,7.803),a.rotation.set(0,.561,0),a.scale.set(3.927,6.285,3.687),a.updateMatrix(),r.setMatrixAt(2,a.matrix),a.position.set(-2.017,.018,6.124),a.rotation.set(0,.333,0),a.scale.set(2.002,4.566,2.064),a.updateMatrix(),r.setMatrixAt(3,a.matrix),a.position.set(2.291,-.756,-2.621),a.rotation.set(0,-.286,0),a.scale.set(1.546,1.552,1.496),a.updateMatrix(),r.setMatrixAt(4,a.matrix),a.position.set(-2.193,-.369,-5.547),a.rotation.set(0,.516,0),a.scale.set(3.875,3.487,2.986),a.updateMatrix(),r.setMatrixAt(5,a.matrix),this.add(r);const l=new p(t,S(50));l.position.set(-16.116,14.37,8.208),l.scale.set(.1,2.428,2.739),this.add(l);const c=new p(t,S(50));c.position.set(-16.109,18.021,-8.207),c.scale.set(.1,2.425,2.751),this.add(c);const u=new p(t,S(17));u.position.set(14.904,12.198,-1.832),u.scale.set(.15,4.265,6.331),this.add(u);const b=new p(t,S(43));b.position.set(-.462,8.89,14.52),b.scale.set(4.38,5.441,.088),this.add(b);const j=new p(t,S(20));j.position.set(3.235,11.486,-12.541),j.scale.set(2.5,2,.1),this.add(j);const E=new p(t,S(100));E.position.set(0,20,0),E.scale.set(1,.1,1),this.add(E)}dispose(){const t=new Set;this.traverse(e=>{e.isMesh&&(t.add(e.geometry),t.add(e.material))});for(const e of t)e.dispose()}}function S(s){return new kt({color:0,emissive:16777215,emissiveIntensity:s})}const me=document.getElementById("scene"),g=new zt({canvas:me,antialias:!0});g.setPixelRatio(Math.min(window.devicePixelRatio,2));g.setSize(window.innerWidth,window.innerHeight);g.setClearColor(132106,1);g.outputColorSpace=It;const y=new dt,fe=new Nt(g);y.environment=fe.fromScene(new ue(g),.04).texture;const v=new Ft(55,window.innerWidth/window.innerHeight,.1,800);v.position.set(0,2,9);const I=new te(v,g.domElement);I.enableDamping=!0;I.dampingFactor=.06;I.minDistance=3.5;I.maxDistance=22;const _e=[],wt=[],ht=`
vec4 mod289(vec4 x){return x - floor(x*(1.0/289.0))*289.0;}
vec4 permute(vec4 x){return mod289(((x*34.0)+1.0)*x);}
vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314*r;}
float snoise(vec3 v){
  const vec2 C = vec2(1.0/6.0, 1.0/3.0);
  const vec4 D = vec4(0.0, 0.5, 1.0, 2.0);
  vec3 i = floor(v + dot(v, C.yyy));
  vec3 x0 = v - i + dot(i, C.xxx);
  vec3 g = step(x0.yzx, x0.xyz);
  vec3 l = 1.0 - g;
  vec3 i1 = min(g.xyz, l.zxy);
  vec3 i2 = max(g.xyz, l.zxy);
  vec3 x1 = x0 - i1 + C.xxx;
  vec3 x2 = x0 - i2 + C.yyy;
  vec3 x3 = x0 - D.yyy;
  i = mod289(i);
  vec4 p = permute( permute( permute(
            i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
          + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))
          + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
  float n_ = 0.142857142857;
  vec3  ns = n_ * D.wyz - D.xzx;
  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);
  vec4 x_ = floor(j * ns.z);
  vec4 y_ = floor(j - 7.0 * x_);
  vec4 x = x_ * ns.x + ns.yyyy;
  vec4 y = y_ * ns.x + ns.yyyy;
  vec4 h = 1.0 - abs(x) - abs(y);
  vec4 b0 = vec4(x.xy, y.xy);
  vec4 b1 = vec4(x.zw, y.zw);
  vec4 s0 = floor(b0)*2.0 + 1.0;
  vec4 s1 = floor(b1)*2.0 + 1.0;
  vec4 sh = -step(h, vec4(0.0));
  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy;
  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww;
  vec3 p0 = vec3(a0.xy, h.x);
  vec3 p1 = vec3(a1.xy, h.y);
  vec3 p2 = vec3(a0.zw, h.z);
  vec3 p3 = vec3(a1.zw, h.w);
  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2,p2), dot(p3,p3)));
  p0 *= norm.x; p1 *= norm.y; p2 *= norm.z; p3 *= norm.w;
  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
  m = m*m;
  return 42.0 * dot(m*m, vec4(dot(p0,x0), dot(p1,x1), dot(p2,x2), dot(p3,x3)));
}`;function ye(s,t={}){const e={scale:1.6,disp:.02,bandFreq:2.2,crater:.35,colorA:1712196,colorB:2768517,...t};return s.onBeforeCompile=o=>{o.uniforms.pTime={value:0},o.uniforms.pScale={value:e.scale},o.uniforms.pDisp={value:e.disp},o.uniforms.pBandFreq={value:e.bandFreq},o.uniforms.pCrater={value:e.crater},o.uniforms.pColorA={value:new Y(e.colorA)},o.uniforms.pColorB={value:new Y(e.colorB)},wt.push(o.uniforms),o.vertexShader=o.vertexShader.replace("#include <common>",`#include <common>
${ht}
varying vec3 vWPos;`).replace("#include <worldpos_vertex>",`#include <worldpos_vertex>
 vWPos = worldPosition.xyz;`).replace("#include <project_vertex>",`
  float n = snoise(normalize(position) * pScale + vec3(pTime*0.03));
  vec3 displaced = position + normal * (n * pDisp);  // pDisp ~ 0.038–0.06 looks good
  vec4 mvPosition = modelViewMatrix * vec4(displaced, 1.0);
  gl_Position = projectionMatrix * mvPosition;
`),o.fragmentShader=o.fragmentShader.replace("#include <common>",`#include <common>
${ht}
varying vec3 vWPos;
uniform float pTime,pScale,pBandFreq,pCrater; uniform vec3 pColorA,pColorB;`).replace("vec4 diffuseColor = vec4( diffuse, opacity );",`
  // latitude color bands + polar caps
  vec3 N = normalize(vWPos);
  vec3 bandCol = mix(pColorA, pColorB, 0.5 + 0.5 * sin(vWPos.y * pBandFreq));
  float lat = abs(N.y);
  float caps = smoothstep(0.58, 0.92, lat);
  bandCol = mix(bandCol, vec3(0.88, 0.93, 1.0), caps * 0.35);

  // crater mask (bright rims, darker pits)
  float nn = snoise(vWPos * (pScale*0.7) + vec3(pTime*0.02));
  float craterMask = smoothstep(0.2, 0.9, abs(nn));
  vec3 craterTint = mix(vec3(1.0), vec3(0.75,0.82,0.95), craterMask * pCrater);

  // gentle albedo AO to add body
  float ao = 0.82 + 0.18 * (snoise(vWPos * (pScale*0.35)) * 0.5 + 0.5);

  diffuse *= bandCol * craterTint * ao;
  roughnessFactor = clamp(roughnessFactor + craterMask * 0.22 * pCrater, 0.0, 1.0);

  vec4 diffuseColor = vec4(diffuse, opacity);
`)},s}y.add(new Yt(6844552,.55));const xt=new $(10407935,110,140);xt.position.set(8,6,10);y.add(xt);const Mt=new $(16752627,70,100);Mt.position.set(-8,-4,-9);y.add(Mt);const Pt=new Wt(10932991,1.2);Pt.position.set(-2.5,1.5,-4.5);y.add(Pt);function vt(s=30,t="rgba(124,247,255,0.35)",e="rgba(124,247,255,0)"){const o=document.createElement("canvas");o.width=o.height=256;const i=o.getContext("2d"),n=i.createRadialGradient(128,128,10,128,128,128);n.addColorStop(0,t),n.addColorStop(1,e),i.fillStyle=n,i.fillRect(0,0,256,256);const r=new U(o),a=new _t(new yt({map:r,transparent:!0,blending:Q,depthWrite:!1}));return a.scale.set(s,s,1),a}const tt=vt(22);tt.position.set(-2.2,1.2,-6);y.add(tt);const w=new W;y.add(w);const k=new p(new R(2,160,160),ye(new ut({color:16777215,roughness:.52,metalness:.08,clearcoat:.65,clearcoatRoughness:.33,sheen:.4,sheenColor:new Y(1714797),emissive:660022,emissiveIntensity:.33}),{scale:1.7,disp:.045,bandFreq:1.9,crater:.42,colorA:1515848,colorB:3495848}));k.castShadow=k.receiveShadow=!0;w.add(k);const O=new p(new R(2.12,128,128),new z({color:8189951,transparent:!0,opacity:.22}));w.add(O);const A=new p(new R(2.06,128,128),new F({transparent:!0,opacity:.22,emissive:16777215,emissiveIntensity:.05}));w.add(A);k.renderOrder=1;O.material.transparent=!0;O.material.depthWrite=!1;O.material.depthTest=!0;O.renderOrder=2;A.material.transparent=!0;A.material.depthWrite=!1;A.material.depthTest=!0;A.renderOrder=3;const ge=new mt({color:16752627,transparent:!0,opacity:.75}),be=new mt({color:8189951,transparent:!0,opacity:.75});function we(s,t,e,o){const i=new gt,n=[];for(let r=0;r<=1;r+=.02){const a=t+r*e,l=2.02,c=l*Math.cos(s)*Math.cos(a),u=l*Math.sin(s),b=l*Math.cos(s)*Math.sin(a);n.push(new _(c,u,b))}i.setFromPoints(n),w.add(new Gt(i,o))}for(let s=0;s<26;s++)we(Math.random()*Math.PI-Math.PI/2,Math.random()*Math.PI*2,.9*Math.PI,s%2?ge:be);function xe(){const s=document.createElement("canvas");s.width=256,s.height=256;const t=s.getContext("2d"),e=t.createLinearGradient(0,0,0,256);e.addColorStop(0,"rgba(156,255,181,0)"),e.addColorStop(.35,"rgba(156,255,181,0.35)"),e.addColorStop(1,"rgba(124,247,255,0)"),t.fillStyle=e,t.fillRect(0,0,256,256);const o=new U(s),i=new z({map:o,transparent:!0,blending:Q,depthWrite:!1,depthTest:!0}),n=new Xt(4.8,2.1,40,1),r=n.attributes.position;for(let l=0;l<r.count;l++){const c=r.getX(l);r.setZ(l,Math.sin(c*1.4)*.25)}const a=new p(n,i);return a.rotation.y=Math.PI/3,a.position.set(0,1.6,.1),a}const et=xe();w.add(et);et.renderOrder=4;function Et(){const s=document.createElement("canvas");s.width=s.height=512;const t=s.getContext("2d"),e=256,o=256,i=250,n=190;for(let a=n;a<=i;a++){const l=(a-n)/(i-n);t.strokeStyle=`rgba(124,247,255,${.35*(1-Math.abs(l-.5)*2)})`,t.beginPath(),t.arc(e,o,a,0,Math.PI*2),t.stroke()}const r=t.createRadialGradient(e,o,n-30,e,o,i+30);return r.addColorStop(0,"rgba(255,255,255,1)"),r.addColorStop(.08,"rgba(255,255,255,0.7)"),r.addColorStop(.92,"rgba(255,255,255,0.7)"),r.addColorStop(1,"rgba(255,255,255,0)"),t.globalCompositeOperation="destination-in",t.fillStyle=r,t.fillRect(0,0,512,512),new U(s)}const K=Et();K.wrapS=K.wrapT=Ut;const P=new p(new ft(2.55,3.25,256,1),new z({map:K,transparent:!0,depthWrite:!1}));P.rotation.x=Math.PI*.53;P.rotation.y=Math.PI*.18;P.position.y=.05;w.add(P);{const s=new Ht(.025,0),t=new F({color:13627391,roughness:.9,metalness:.05,emissive:8189951,emissiveIntensity:.05}),e=420,o=new pt(s,t,e),i=new Zt;for(let n=0;n<e;n++){const r=Math.random()*Math.PI*2,a=M.randFloat(2.62,3.18),l=M.randFloatSpread(.08),c=Math.cos(r)*a,u=Math.sin(r)*a;i.makeRotationFromEuler(new Kt(Math.random(),Math.random(),Math.random())),i.setPosition(new _(c,l,u)),o.setMatrixAt(n,i)}o.instanceMatrix.needsUpdate=!0,o.rotation.x=P.rotation.x,o.rotation.y=P.rotation.y,o.position.copy(P.position),w.add(o)}function st(s,t,e=40,o=260){const i=new gt,n=new Float32Array(s*3);for(let a=0;a<s;a++){const l=M.randFloat(e,o),c=Math.random()*Math.PI*2,u=Math.acos(M.randFloatSpread(2));n[a*3]=l*Math.sin(u)*Math.cos(c),n[a*3+1]=l*Math.cos(u),n[a*3+2]=l*Math.sin(u)*Math.sin(c)}i.setAttribute("position",new qt(n,3));const r=new Vt({color:16777215,size:t,sizeAttenuation:!0,transparent:!0,opacity:.9});return new $t(i,r)}const B=st(1400,.2,35,120),G=st(1200,.12,60,160),X=st(1600,.07,140,320);y.add(X,G,B);function Me(s,t,e,o=.7){const i=vt(2.2,"rgba(255,255,255,0.95)","rgba(255,255,255,0)");return i.scale.setScalar(o*4),i.position.set(s,t,e),y.add(i),i}const St=[];for(let s=0;s<14;s++){const t=M.randFloat(60,180),e=Math.random()*Math.PI*2,o=Math.acos(M.randFloatSpread(2));St.push(Me(t*Math.sin(o)*Math.cos(e),t*Math.cos(o),t*Math.sin(o)*Math.sin(e),M.randFloat(.8,1.35)))}const C=new W;y.add(C);const Pe=`
float hash(vec3 p){
  p = fract(p * 0.3183099 + .1);
  p *= 17.0;
  return fract(p.x * p.y * p.z * (p.x + p.y + p.z));
}
float fbm(vec3 p){
  float v = 0.0;
  v += 0.5 * hash(p);
  v += 0.25 * hash(p * 2.1);
  v += 0.125 * hash(p * 4.3);
  v += 0.0625 * hash(p * 8.7);
  return v;
}
`;function ve(s){return new Qt({uniforms:{uColor:{value:new Y(s)},uTime:{value:0}},vertexShader:`
      varying vec3 vPos;
      void main(){
        vPos = position;
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);
      }
    `,fragmentShader:`
      varying vec3 vPos;
      uniform vec3 uColor;
      uniform float uTime;
      ${Pe}
      void main(){
        vec3 p = normalize(vPos) * 3.0;
        float n = fbm(p + vec3(uTime*0.1));
        float crater = smoothstep(0.2,0.8,abs(n));
        vec3 c = mix(uColor*0.7, uColor*1.2, crater);
        gl_FragColor = vec4(c, 1.0);
      }
    `,lights:!1})}function ot(s,t,e,o,i,n=.28){const r=new W,a=ve(s),l=new p(new R(n,64,64),a);r.add(l);const c=document.createElement("canvas");c.width=c.height=256;const u=c.getContext("2d"),b=u.createRadialGradient(128,128,20,128,128,128);b.addColorStop(0,"rgba(255,255,255,0.4)"),b.addColorStop(1,"rgba(255,255,255,0)"),u.fillStyle=b,u.fillRect(0,0,256,256);const j=new U(c),E=new _t(new yt({map:j,transparent:!0,blending:Q,depthWrite:!1}));return E.scale.set(1.2,1.2,1),r.add(E),r.userData={radius:t,angle:Math.random()*Math.PI*2,speed:e,label:o,href:i,mat:a},C.add(r),r}const Ee=ot(8189951,3.6,.62,"Projects","#projects"),Se=ot(16752627,4.6,.44,"About","#about"),De=ot(10289077,5.4,.3,"Resume","Resume.pdf"),q=document.getElementById("labels"),Dt=new Map;q&&[Ee,Se,De].forEach(s=>{const t=document.createElement("div");t.className="label";const{label:e,href:o}=s.userData;t.innerHTML=o.endsWith(".pdf")?`<a href="${o}" target="_blank" rel="noopener">${e} ↗</a>`:`<a href="${o}">${e}</a>`,q.appendChild(t),Dt.set(s,t)});const L=new W;L.position.set(-12,6,-24);y.add(L);const Te=new p(new R(1.25,96,96),new ut({color:1319992,roughness:.5,metalness:.1,clearcoat:.5,clearcoatRoughness:.4,emissive:529446,emissiveIntensity:.25}));L.add(Te);const Ce=new p(new R(1.31,64,64),new z({color:10141695,transparent:!0,opacity:.15}));L.add(Ce);const H=new p(new ft(1.5,1.85,160,1),new z({map:Et(),transparent:!0,depthWrite:!1}));H.rotation.x=Math.PI*.72;H.rotation.y=Math.PI*.18;L.add(H);const lt=new Bt,V=new f;window.addEventListener("pointermove",s=>{V.x=s.clientX/window.innerWidth*2-1,V.y=-(s.clientY/window.innerHeight)*2+1});window.addEventListener("click",()=>{lt.setFromCamera(V,v);const s=lt.intersectObjects(C.children,!0);if(s[0]){let t=s[0].object;for(;t.parent&&!t.userData.href;)t=t.parent;const{href:e}=t.userData;e.endsWith(".pdf")?window.open(e,"_blank","noopener"):window.location.hash=e}});window.addEventListener("resize",()=>{v.aspect=window.innerWidth/window.innerHeight,v.updateProjectionMatrix(),g.setSize(window.innerWidth,window.innerHeight)});let x=0;function Tt(){requestAnimationFrame(Tt),x+=.005,k.rotation.y+=.0012,A.rotation.y+=.0018,w.rotation.y+=9e-4,O.material.opacity=.2+Math.sin(x*2)*.03,et.position.y=1.55+Math.sin(x*1.5)*.05,P.rotation.z+=6e-4,tt.material.opacity=.3+Math.sin(x*1.3)*.05,L.rotation.y-=6e-4,H.rotation.z-=3e-4,X.rotation.y-=1e-4,G.rotation.y-=25e-5,B.rotation.y-=45e-5;const s=.2*(Math.sin(x*5)*.5+.5);if(B.material.opacity=.85+s*.2,G.material.opacity=.75+Math.sin(x*3+1.2)*.18,X.material.opacity=.65+Math.sin(x*2.1+2.3)*.15,St.forEach((t,e)=>{t.material.opacity=.55+Math.sin(x*3+e)*.4}),C.children.forEach(t=>{const e=t.userData;e.angle+=.01*e.speed;const o=e.radius;t.position.set(Math.cos(e.angle)*o,Math.sin(e.angle*1.15)*.45,Math.sin(e.angle)*o),t.rotation.y+=.01}),q){const t=g.domElement.clientWidth,e=g.domElement.clientHeight;C.children.forEach(o=>{const i=Dt.get(o);if(!i)return;const n=o.position.clone().project(v);i.style.display=n.z>1?"none":"block",i.style.left=`${(n.x*.5+.5)*t}px`,i.style.top=`${(-n.y*.5+.5)*e}px`})}for(const t of _e)t.uTime&&(t.uTime.value+=.5*.016);C.children.forEach(t=>{t.userData.mat&&(t.userData.mat.uniforms.uTime.value+=.005)});for(const t of wt)t.pTime&&(t.pTime.value+=.016*.5);I.update(),g.render(y,v)}Tt();const ct=document.getElementById("year");ct&&(ct.textContent=new Date().getFullYear());
